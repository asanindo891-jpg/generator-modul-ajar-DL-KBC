<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generator Modul Ajar AI</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}
.container {
  background: white;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  max-width: 600px;
  width: 100%;
  padding: 40px;
  animation: fadeIn 0.5s;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}
h1 {
  color: #667eea;
  text-align: center;
  margin-bottom: 10px;
  font-size: 2em;
}
.subtitle {
  text-align: center;
  color: #666;
  margin-bottom: 30px;
  font-size: 0.9em;
}
.form-group {
  margin-bottom: 20px;
}
label {
  display: block;
  margin-bottom: 8px;
  color: #333;
  font-weight: 600;
  font-size: 0.95em;
}
input, select, textarea {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1em;
  transition: border 0.3s;
  font-family: inherit;
}
input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: #667eea;
}
textarea {
  resize: vertical;
  min-height: 80px;
}
.btn {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  margin-top: 10px;
}
.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
}
.btn:active {
  transform: translateY(0);
}
.loading {
  display: none;
  text-align: center;
  padding: 30px;
}
.loading-spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #667eea;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
.success {
  display: none;
  background: #d1fae5;
  border: 2px solid #10b981;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  color: #065f46;
  margin-top: 20px;
}
.info-box {
  background: #fef3c7;
  border-left: 4px solid #f59e0b;
  padding: 15px;
  border-radius: 5px;
  margin-bottom: 20px;
  font-size: 0.9em;
}
.footer {
  text-align: center;
  margin-top: 30px;
  color: #666;
  font-size: 0.85em;
}
.footer a {
  color: #667eea;
  text-decoration: none;
  font-weight: 600;
}
@media (max-width: 600px) {
  .container { padding: 25px; }
  h1 { font-size: 1.5em; }
}
</style>
</head>
<body>
<div class="container">
  <h1>ü§ñ Generator Modul Ajar AI</h1>
  <p class="subtitle">Kurikulum Merdeka - SD, SMP/MTs, SMA/MA/SMK</p>
  
  <div class="info-box">
    <strong>‚ú® Fitur:</strong> Generate modul ajar lengkap dalam 3 detik! Otomatis sesuai format Kurikulum Merdeka dengan HOTS, Asesmen, Diferensiasi, dan P5.
  </div>

  <div id="formContainer">
    <div class="form-group">
      <label>Jenjang Pendidikan</label>
      <select id="jenjang">
        <option value="">-- Pilih Jenjang --</option>
        <option value="SD">SD</option>
        <option value="SMP">SMP</option>
        <option value="MTs">MTs</option>
        <option value="SMA">SMA</option>
        <option value="MA">MA</option>
        <option value="SMK">SMK</option>
      </select>
    </div>

    <div class="form-group">
      <label>Mata Pelajaran</label>
      <input type="text" id="mataPelajaran" placeholder="Contoh: Matematika, IPA, Bahasa Indonesia">
    </div>

    <div class="form-group">
      <label>Kelas</label>
      <input type="text" id="kelas" placeholder="Contoh: VII, X, 5">
    </div>

    <div class="form-group">
      <label>Topik/Materi Pembelajaran</label>
      <input type="text" id="topik" placeholder="Contoh: Persamaan Linear, Sistem Pencernaan">
    </div>

    <div class="form-group">
      <label>Alokasi Waktu</label>
      <input type="text" id="alokasi" placeholder="Contoh: 2 x 45 menit" value="2 x 45 menit">
    </div>

    <div class="form-group">
      <label>Catatan Tambahan (Opsional)</label>
      <textarea id="catatan" placeholder="Contoh: Fokus pada pembelajaran berbasis proyek, siswa kesulitan di materi prasyarat, dll"></textarea>
    </div>

    <button class="btn" onclick="generateModul()">üöÄ Generate Modul Ajar Sekarang</button>
  </div>

  <div id="loadingContainer" class="loading">
    <div class="loading-spinner"></div>
    <p style="color: #667eea; font-weight: 600; font-size: 1.1em;">ü§ñ AI sedang membuat modul...</p>
    <p style="color: #999; margin-top: 10px;">Tunggu 3 detik</p>
  </div>

  <div id="successContainer" class="success">
    <h3 style="margin-bottom: 10px;">‚úÖ Modul Ajar Berhasil Dibuat!</h3>
    <p>File akan otomatis terdownload dalam format .docx</p>
    <button class="btn" onclick="resetForm()" style="margin-top: 15px; background: #10b981;">üìù Buat Modul Lagi</button>
  </div>

  <div class="footer">
    Powered by AI ‚Ä¢ <a href="https://bahasaindonesiama.blogspot.com" target="_blank">BahasaIndonesiaMA.blogspot.com</a>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script>
function generateModul() {
  const jenjang = document.getElementById('jenjang').value.trim();
  const mapel = document.getElementById('mataPelajaran').value.trim();
  const kelas = document.getElementById('kelas').value.trim();
  const topik = document.getElementById('topik').value.trim();
  const alokasi = document.getElementById('alokasi').value.trim();
  const catatan = document.getElementById('catatan').value.trim();

  if (!jenjang || !mapel || !kelas || !topik) {
    alert('‚ö†Ô∏è Mohon isi semua field yang wajib (Jenjang, Mata Pelajaran, Kelas, Topik)!');
    return;
  }

  // Tampilkan loading
  document.getElementById('formContainer').style.display = 'none';
  document.getElementById('loadingContainer').style.display = 'block';

  // Simulasi AI processing
  setTimeout(function() {
    const modulData = buatModulLengkap(jenjang, mapel, kelas, topik, alokasi, catatan);
    generateWordDoc(modulData, mapel, kelas, topik);
  }, 3000);
}

function buatModulLengkap(jenjang, mapel, kelas, topik, alokasi, catatan) {
  const tahunAjar = '2024/2025';
  
  return {
    // IDENTITAS
    jenjang: jenjang,
    mataPelajaran: mapel,
    kelas: kelas,
    semester: '1',
    tahunPelajaran: tahunAjar,
    alokasi: alokasi,
    topik: topik,
    
    // CAPAIAN PEMBELAJARAN
    capaianPembelajaran: `Peserta didik mampu memahami, menganalisis, dan menerapkan konsep ${topik} dalam mata pelajaran ${mapel} dengan mengembangkan kemampuan berpikir tingkat tinggi (HOTS), kreativitas, dan keterampilan pemecahan masalah yang relevan dengan kehidupan sehari-hari.`,
    
    // TUJUAN PEMBELAJARAN (HOTS)
    tujuanPembelajaran: [
      `Menganalisis konsep dasar ${topik} dan hubungannya dengan kehidupan sehari-hari`,
      `Mengevaluasi berbagai strategi dan metode dalam menyelesaikan masalah terkait ${topik}`,
      `Menciptakan solusi inovatif atau produk kreatif berdasarkan pemahaman ${topik}`
    ],
    
    // PEMAHAMAN BERMAKNA
    pemahamanBermakna: [
      `${topik} merupakan konsep penting dalam ${mapel} yang memiliki aplikasi praktis dalam kehidupan sehari-hari`,
      `Memahami ${topik} membantu peserta didik mengembangkan kemampuan berpikir logis, sistematis, dan kritis`,
      `Penguasaan ${topik} memberikan fondasi kuat untuk pembelajaran materi selanjutnya`
    ],
    
    // PERTANYAAN PEMANTIK
    pertanyaanPemantik: [
      `Mengapa ${topik} penting untuk dipelajari dalam konteks kehidupan modern?`,
      `Bagaimana ${topik} dapat diterapkan untuk menyelesaikan masalah nyata di sekitar kita?`,
      `Apa hubungan antara ${topik} dengan materi yang telah kita pelajari sebelumnya?`,
      `Bagaimana teknologi dapat membantu kita memahami ${topik} dengan lebih baik?`
    ],
    
    // KEGIATAN PEMBELAJARAN
    kegiatanPendahuluan: `1. Guru membuka pembelajaran dengan salam, berdoa, dan mengecek kehadiran peserta didik
2. Guru melakukan apersepsi dengan mengaitkan ${topik} dengan pengalaman atau pengetahuan peserta didik sebelumnya
3. Guru menyampaikan tujuan pembelajaran dan kompetensi yang akan dicapai
4. Guru memberikan motivasi dengan menjelaskan manfaat dan relevansi ${topik} dalam kehidupan sehari-hari
5. Guru menyampaikan rencana kegiatan dan metode penilaian yang akan digunakan`,

    kegiatanInti: `FASE EKSPLORASI (Stimulation & Problem Statement):
- Peserta didik mengamati fenomena, video, gambar, atau studi kasus terkait ${topik}
- Guru memfasilitasi diskusi untuk mengidentifikasi masalah atau pertanyaan yang muncul
- Peserta didik merumuskan pertanyaan atau hipotesis awal tentang ${topik}

FASE ELABORASI (Data Collection & Processing):
- Peserta didik dibagi dalam kelompok kecil (4-5 orang) untuk mengumpulkan informasi
- Setiap kelompok melakukan eksplorasi mendalam tentang ${topik} melalui:
  * Diskusi kelompok dan brainstorming
  * Membaca sumber belajar (buku, artikel, referensi digital)
  * Melakukan eksperimen atau praktikum (jika relevan)
  * Menganalisis data dan informasi yang diperoleh
- Guru berkeliling membimbing dan memfasilitasi proses pembelajaran
- Peserta didik mengolah informasi dan menyusun kesimpulan sementara

FASE KREASI (Verification & Generalization):
- Setiap kelompok mempresentasikan hasil analisis dan kesimpulan mereka
- Kelompok lain memberikan tanggapan, pertanyaan, atau saran perbaikan
- Guru memberikan umpan balik dan penguatan konsep ${topik}
- Peserta didik menciptakan produk/karya yang mendemonstrasikan pemahaman mereka:
  * Laporan tertulis dengan analisis mendalam
  * Presentasi multimedia atau infografis
  * Model, prototype, atau demonstrasi praktis
  * Video tutorial atau penjelasan konsep
- Peserta didik menyusun kesimpulan akhir dan generalisasi konsep`,

    kegiatanPenutup: `1. Guru bersama peserta didik menyimpulkan materi pembelajaran tentang ${topik}
2. Peserta didik melakukan refleksi terhadap proses pembelajaran:
   - Apa yang telah dipelajari hari ini?
   - Apa tantangan yang dihadapi dan bagaimana mengatasinya?
   - Bagaimana materi ini bermanfaat untuk kehidupan?
3. Guru memberikan penguatan terhadap pencapaian peserta didik
4. Guru melakukan penilaian sikap selama pembelajaran
5. Guru menyampaikan rencana pembelajaran pertemuan berikutnya
6. Guru memberikan tugas atau proyek sebagai tindak lanjut
7. Pembelajaran ditutup dengan doa dan salam`,
    
    // ASESMEN
    asesmenDiagnostik: `Asesmen diagnostik dilakukan di awal pembelajaran untuk mengidentifikasi pengetahuan awal dan kesiapan belajar peserta didik:
- Pre-test lisan atau tertulis tentang konsep prasyarat ${topik}
- Tanya jawab interaktif untuk mengeksplorasi pemahaman awal
- Kuesioner atau angket tentang pengalaman belajar sebelumnya
- Observasi kesiapan dan motivasi belajar peserta didik
Hasil asesmen ini digunakan untuk menyesuaikan strategi pembelajaran dan diferensiasi.`,

    asesmenFormatif: `Asesmen formatif dilakukan selama proses pembelajaran untuk memantau perkembangan dan memberikan umpan balik:
- Observasi aktivitas dan partisipasi dalam diskusi kelompok
- Penilaian hasil kerja kelompok (analisis, laporan, presentasi)
- Kuis singkat atau latihan soal di pertengahan pembelajaran
- Pertanyaan lisan untuk mengecek pemahaman konsep
- Penilaian proses pengerjaan proyek atau eksperimen
- Peer assessment dan self assessment
Umpan balik diberikan segera untuk perbaikan pembelajaran.`,

    asesmenSumatif: `Asesmen sumatif dilakukan di akhir pembelajaran untuk mengukur pencapaian tujuan pembelajaran:
1. Tes Tertulis (Bobot 40%):
   - Pilihan ganda: mengukur pemahaman konsep ${topik}
   - Uraian: mengukur kemampuan analisis dan evaluasi
   - Studi kasus: mengukur kemampuan aplikasi dalam situasi nyata

2. Penilaian Proyek/Produk (Bobot 40%):
   - Kualitas produk/karya yang dihasilkan
   - Kreativitas dan inovasi dalam solusi
   - Kesesuaian dengan kriteria yang ditentukan
   - Kemampuan menjelaskan dan mempertanggungjawabkan

3. Presentasi dan Komunikasi (Bobot 20%):
   - Kemampuan menyampaikan ide dengan jelas
   - Kemampuan menjawab pertanyaan
   - Penggunaan media presentasi yang efektif`,
    
    // PEMBELAJARAN BERDIFERENSIASI
    diferensiasiKonten: `Diferensiasi Konten disesuaikan dengan kesiapan dan kemampuan peserta didik:

TINGKAT DASAR (Pemula):
- Materi ${topik} disajikan dengan penjelasan sederhana dan konkret
- Banyak contoh visual dan ilustrasi
- Fokus pada konsep fundamental
- Tersedia panduan langkah demi langkah

TINGKAT MENENGAH (Berkembang):
- Materi lebih kompleks dengan contoh bervariasi
- Kombinasi konsep teoritis dan aplikasi praktis
- Latihan soal dengan tingkat kesulitan bertahap

TINGKAT LANJUT (Mahir):
- Materi mendalam dengan analisis kritis
- Studi kasus kompleks dan tantangan pemecahan masalah
- Eksplorasi aplikasi lanjutan ${topik}
- Kesempatan untuk penelitian mandiri

Sumber belajar tersedia dalam berbagai format: teks, video, audio, infografis, simulasi interaktif`,

    diferensiasiProses: `Diferensiasi Proses memberikan variasi cara belajar sesuai gaya belajar peserta didik:

PEMBELAJARAN VISUAL:
- Menggunakan diagram, grafik, peta konsep
- Video pembelajaran dan animasi
- Infografis dan mind mapping

PEMBELAJARAN AUDITORI:
- Diskusi dan presentasi oral
- Podcast atau penjelasan verbal
- Metode tanya jawab interaktif

PEMBELAJARAN KINESTETIK:
- Eksperimen hands-on dan praktikum
- Simulasi dan permainan edukatif
- Proyek berbasis aktivitas fisik

FLEKSIBILITAS METODE:
- Pembelajaran individual untuk yang mandiri
- Pembelajaran kelompok kecil untuk yang kolaboratif
- Pembelajaran klasikal untuk penguatan konsep
- Pembelajaran berbasis teknologi untuk yang digital native

DUKUNGAN SCAFFOLDING:
- Panduan terstruktur untuk yang membutuhkan
- Peer tutoring dan belajar teman sebaya
- Konsultasi individual dengan guru`,

    diferensiasiProduk: `Diferensiasi Produk memberikan pilihan cara mendemonstrasikan pemahaman:

PRODUK TERTULIS:
- Laporan penelitian atau essay analitis
- Artikel ilmiah populer
- Ringkasan atau rangkuman kreatif
- Portfolio dokumentasi pembelajaran

PRODUK VISUAL:
- Poster atau infografis
- Presentasi multimedia (PPT, Canva, Prezi)
- Video tutorial atau vlog penjelasan
- Komik atau ilustrasi konsep
- Mind map atau diagram digital

PRODUK PRAKTIS:
- Model atau prototype
- Demonstrasi praktik
- Eksperimen dan laporan hasil
- Produk inovatif berbasis ${topik}

PRODUK DIGITAL:
- Website atau blog edukatif
- Aplikasi sederhana atau simulasi
- Podcast atau audio explanation
- E-book atau modul digital

PRODUK KOLABORATIF:
- Proyek kelompok dengan pembagian peran
- Presentasi tim
- Drama atau role play
- Pameran karya kelompok

Setiap jenis produk memiliki rubrik penilaian yang jelas dan disesuaikan dengan karakteristiknya`,
    
    // PROFIL PELAJAR PANCASILA
    p5Dimensi: ['Beriman, Bertakwa kepada Tuhan YME, dan Berakhlak Mulia', 'Berkebinekaan Global', 'Bergotong Royong', 'Mandiri', 'Bernalar Kritis', 'Kreatif'],
    
    p5Keterkaitan: `Pembelajaran ${topik} dalam ${mapel} mengembangkan dimensi Profil Pelajar Pancasila:

1. BERIMAN, BERTAKWA, DAN BERAKHLAK MULIA:
   - Mensyukuri kemampuan berpikir yang dianugerahkan Tuhan
   - Menggunakan ilmu pengetahuan untuk kebaikan dan kesejahteraan
   - Jujur dalam mengerjakan tugas dan menghargai karya orang lain

2. BERKEBINEKAAN GLOBAL:
   - Menghargai keberagaman pendapat dan cara berpikir dalam kelompok
   - Memahami bahwa ${topik} dipelajari dan diterapkan di berbagai budaya
   - Berkolaborasi dengan teman dari latar belakang berbeda

3. BERGOTONG ROYONG:
   - Bekerja sama dalam kelompok untuk menyelesaikan proyek ${topik}
   - Saling membantu teman yang mengalami kesulitan
   - Berbagi pengetahuan dan sumber belajar

4. MANDIRI:
   - Mengambil inisiatif dalam proses pembelajaran
   - Bertanggung jawab menyelesaikan tugas tepat waktu
   - Mencari sumber belajar tambahan secara proaktif
   - Melakukan refleksi dan evaluasi diri

5. BERNALAR KRITIS:
   - Menganalisis informasi dan data terkait ${topik} secara objektif
   - Mengevaluasi berbagai solusi dan memilih yang paling efektif
   - Mempertanyakan asumsi dan mencari bukti
   - Membuat keputusan berdasarkan logika dan data

6. KREATIF:
   - Menghasilkan ide-ide inovatif dalam penerapan ${topik}
   - Menciptakan produk atau solusi yang unik dan orisinal
   - Berani mencoba pendekatan baru dalam pemecahan masalah
   - Mengekspresikan pemahaman dengan cara yang kreatif`,
    
    // MEDIA DAN SUMBER BELAJAR
    mediaSumber: [
      `Buku teks ${mapel} ${jenjang} Kelas ${kelas} (Kemendikbudristek)`,
      `Modul dan LKPD (Lembar Kerja Peserta Didik) tentang ${topik}`,
      `Video pembelajaran dari platform edukatif (YouTube Education, Khan Academy, Rumah Belajar)`,
      `Aplikasi dan software edukatif yang relevan dengan ${topik}`,
      `Sumber digital: artikel ilmiah, jurnal, e-book, dan website edukatif terpercaya`,
      `Alat peraga dan media konkret untuk demonstrasi konsep`,
      `Proyektor/LCD, laptop, dan perangkat presentasi`,
      `Internet dan platform pembelajaran online (Google Classroom, Moodle, dll)`,
      `Laboratorium atau ruang praktikum (jika diperlukan)`,
      `Lingkungan sekitar sebagai sumber belajar kontekstual`
    ],
    
    // CATATAN TAMBAHAN
    catatan: catatan || 'Tidak ada catatan tambahan'
  };
}

function generateWordDoc(data, mapel, kelas, topik) {
  const { Document, Paragraph, TextRun, HeadingLevel, AlignmentType, BorderStyle } = docx;

  const doc = new Document({
    sections: [{
      properties: {},
      children: [
        // JUDUL
        new Paragraph({
          text: "MODUL AJAR",
          heading: HeadingLevel.HEADING_1,
          alignment: AlignmentType.CENTER,
          spacing: { after: 200 }
        }),
        new Paragraph({
          text: "KURIKULUM MERDEKA",
          heading: HeadingLevel.HEADING_2,
          alignment: AlignmentType.CENTER,
          spacing: { after: 400 }
        }),

        // INFORMASI UMUM
        new Paragraph({
          text: "INFORMASI UMUM",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        new Paragraph({ text: `Jenjang Pendidikan\t: ${data.jenjang}` }),
        new Paragraph({ text: `Mata Pelajaran\t\t: ${data.mataPelajaran}` }),
        new Paragraph({ text: `Kelas/Semester\t\t: ${data.kelas} / ${data.semester}` }),
        new Paragraph({ text: `Tahun Pelajaran\t\t: ${data.tahunPelajaran}` }),
        new Paragraph({ text: `Alokasi Waktu\t\t: ${data.alokasi}` }),
        new Paragraph({ text: `Topik/Materi\t\t: ${data.topik}`, spacing: { after: 300 } }),

        // CAPAIAN PEMBELAJARAN
        new Paragraph({
          text: "A. CAPAIAN PEMBELAJARAN (CP)",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        new Paragraph({
          text: data.capaianPembelajaran,
          spacing: { after: 300 }
        }),

        // TUJUAN PEMBELAJARAN
        new Paragraph({
          text: "B. TUJUAN PEMBELAJARAN",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        new Paragraph({ text: "Setelah mengikuti pembelajaran ini, peserta didik diharapkan mampu:" }),
        ...data.tujuanPembelajaran.map((tujuan, i) => 
          new Paragraph({ text: `${i + 1}. ${tujuan}`, spacing: { after: 100 } })
        ),
        new Paragraph({ text: "", spacing: { after: 200 } }),

        // PEMAHAMAN BERMAKNA
        new Paragraph({
          text: "C. PEMAHAMAN BERMAKNA",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        ...data.pemahamanBermakna.map((pemahaman, i) => 
          new Paragraph({ text: `${i + 1}. ${pemahaman}`, spacing: { after: 100 } })
        ),
        new Paragraph({ text: "", spacing: { after: 200 } }),

        // PERTANYAAN PEMANTIK
        new Paragraph({
          text: "D. PERTANYAAN PEMANTIK",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        ...data.pertanyaanPemantik.map((pertanyaan, i) => 
          new Paragraph({ text: `${i + 1}. ${pertanyaan}`, spacing: { after: 100 } })
        ),
        new Paragraph({ text: "", spacing: { after: 200 } }),

        // KEGIATAN PEMBELAJARAN
        new Paragraph({
          text: "E. KEGIATAN PEMBELAJARAN",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        
        new Paragraph({
          text: "1. Kegiatan Pendahuluan",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.kegiatanPendahuluan, spacing: { after: 300 } }),

        new Paragraph({
          text: "2. Kegiatan Inti",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.kegiatanInti, spacing: { after: 300 } }),

        new Paragraph({
          text: "3. Kegiatan Penutup",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.kegiatanPenutup, spacing: { after: 300 } }),

        // ASESMEN
        new Paragraph({
          text: "F. ASESMEN",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        
        new Paragraph({
          text: "1. Asesmen Diagnostik",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.asesmenDiagnostik, spacing: { after: 300 } }),

        new Paragraph({
          text: "2. Asesmen Formatif",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.asesmenFormatif, spacing: { after: 300 } }),

        new Paragraph({
          text: "3. Asesmen Sumatif",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.asesmenSumatif, spacing: { after: 300 } }),

        // PEMBELAJARAN BERDIFERENSIASI
        new Paragraph({
          text: "G. PEMBELAJARAN BERDIFERENSIASI",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        
        new Paragraph({
          text: "1. Diferensiasi Konten",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.diferensiasiKonten, spacing: { after: 300 } }),

        new Paragraph({
          text: "2. Diferensiasi Proses",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.diferensiasiProses, spacing: { after: 300 } }),

        new Paragraph({
          text: "3. Diferensiasi Produk",
          heading: HeadingLevel.HEADING_2,
          spacing: { after: 150 }
        }),
        new Paragraph({ text: data.diferensiasiProduk, spacing: { after: 300 } }),

        // PROFIL PELAJAR PANCASILA
        new Paragraph({
          text: "H. PROFIL PELAJAR PANCASILA",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        
        new Paragraph({
          text: "Dimensi yang Dikembangkan:",
          heading: HeadingLevel.HEADING_3,
          spacing: { after: 150 }
        }),
        ...data.p5Dimensi.map((dimensi, i) => 
          new Paragraph({ text: `${i + 1}. ${dimensi}`, spacing: { after: 100 } })
        ),
        
        new Paragraph({
          text: "Keterkaitan dengan Pembelajaran:",
          heading: HeadingLevel.HEADING_3,
          spacing: { before: 300, after: 150 }
        }),
        new Paragraph({ text: data.p5Keterkaitan, spacing: { after: 300 } }),

        // MEDIA DAN SUMBER BELAJAR
        new Paragraph({
          text: "I. MEDIA PEMBELAJARAN DAN SUMBER BELAJAR",
          heading: HeadingLevel.HEADING_1,
          spacing: { before: 400, after: 200 }
        }),
        ...data.mediaSumber.map((media, i) => 
          new Paragraph({ text: `${i + 1}. ${media}`, spacing: { after: 100 } })
        ),

        // PENUTUP
        new Paragraph({
          text: "",
          spacing: { before: 600 }
        }),
        new Paragraph({
          text: "___________________________",
          alignment: AlignmentType.CENTER,
          spacing: { before: 400, after: 200 }
        }),
        new Paragraph({
          text: "Modul Ajar ini dibuat dengan Generator AI",
          alignment: AlignmentType.CENTER,
          italics: true
        }),
        new Paragraph({
          text: "BahasaIndonesiaMA.blogspot.com",
          alignment: AlignmentType.CENTER,
          italics: true
        })
      ]
    }]
  });

  // Generate dan download
  docx.Packer.toBlob(doc).then(blob => {
    const filename = `Modul_Ajar_${mapel.replace(/\s+/g, '_')}_Kelas_${kelas}_${topik.replace(/\s+/g, '_')}.docx`;
    saveAs(blob, filename);
    
    // Tampilkan success
    document.getElementById('loadingContainer').style.display = 'none';
    document.getElementById('successContainer').style.display = 'block';
  });
}

function resetForm() {
  document.getElementById('jenjang').value = '';
  document.getElementById('mataPelajaran').value = '';
  document.getElementById('kelas').value = '';
  document.getElementById('topik').value = '';
  document.getElementById('alokasi').value = '2 x 45 menit';
  document.getElementById('catatan').value = '';
  
  document.getElementById('formContainer').style.display = 'block';
  document.getElementById('successContainer').style.display = 'none';
}
</script>
</body>
</html>
